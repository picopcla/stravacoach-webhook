<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Coach Running</title>
    <link rel="manifest" href="/static/manifest.json">
    <link rel="icon" href="/static/icons/icon-192.png">
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/static/service-worker.js')
          .then(() => console.log('Service Worker enregistré'))
          .catch((err) => console.log('Erreur SW', err));
      }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 700px; margin: auto; background: #fff; }
        .header {
            display: flex;
            align-items: center;
            background: linear-gradient(to bottom, orange, #ff9900);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .header img {
            height: 40px;
            margin-right: 15px;
        }
        h1 { margin: 0; font-size: 1.8em; }
        .section { margin: 20px 0; }
        table { border-collapse: collapse; width: 100%; margin: 10px 0; }
        td, th { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #f4f4f4; }
        a { color: #2e8b57; text-decoration: none; }
    </style>
</head>
<body>

<div class="header">
    <img src="/static/icons/icon-192.png" alt="App Icon">
    <h1>Mon Coach Running</h1>
</div>

<p><a href="/profile">⚙ Modifier mon profil</a></p>

<div class="section">
    <h2>Dernier run ({{ dashboard.date }})</h2>
    <table>
        <tr>
            <th>Distance</th><th>Durée</th><th>Allure</th><th>FC Moy</th><th>FC Max</th>
        </tr>
        <tr>
            <td>{{ dashboard.distance_km }} km</td>
            <td>{{ dashboard.duration_min }} min</td>
            <td>{{ dashboard.allure }}/km</td>
            <td>{{ dashboard.fc_moy }} bpm</td>
            <td>{{ dashboard.fc_max }} bpm</td>
        </tr>
    </table>
</div>

<div class="section">
    <canvas id="myChart" height="200"></canvas>
</div>

<script>
    var ctx = document.getElementById('myChart').getContext('2d');
    var chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: {{ dashboard.dates }},
            datasets: [{
                label: 'Allure',
                data: {{ dashboard.paces }},
                fill: false,
                borderColor: '#2e8b57',
                tension: 0.4  // <== courbe lissée
            }]
        },
        options: {
            scales: {
                x: { display: true },
                y: { beginAtZero: false }
            }
        }
    });
</script>

</body>
</html>
